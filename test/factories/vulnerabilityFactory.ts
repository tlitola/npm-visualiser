import { PackageVulnerability } from "@/utils/Package";
import { Factory } from "fishery";
import { ThreatLevels } from "@/utils/constants/constants";

export const VulnerabilityFactory = Factory.define<PackageVulnerability>(({ sequence }) => ({
  id: "Id " + sequence,
  version: sequence.toString(),
  name: "Name" + sequence,
  summary: "Summary" + sequence,
  details: "Details" + sequence,
  published: "Published" + sequence,
  modified: "Modified" + sequence,
  severity: {
    score: 5.4,
    text: "medium" as ThreatLevels,
    vector: "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N",
  },
  from: "From" + sequence,
  to: "To" + sequence,
}));

export const buildVulnerabilitiesRecord = (...vulnerabilities: PackageVulnerability[][]) =>
  vulnerabilities.reduce(
    (acc, p, i) => {
      acc["test" + "@" + i] = p;
      return acc;
    },
    {} as Record<string, PackageVulnerability[]>,
  );
